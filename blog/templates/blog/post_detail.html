{% extends "base.html" %} {% load static %} {% load markdown_extras %} 
{% block title %}{{ post.title }} - Postify{% endblock %} {% block css_files %}
<link rel="stylesheet" href="{% static 'blog/post_detail.css' %}" />
{% endblock %} {% block content %}
<div class="post-detail-container">
  <div class="post-actions-bar">
    <a href="{% url 'blog_home' %}" class="back-link">‚Üê Back to Blog</a>
    {% if user.is_authenticated and user == post.author %}
    <div class="post-author-actions">
      <a href="{% url 'edit_blog' post.slug %}" class="btn-edit-post"
        >‚úèÔ∏è Edit Post</a
      >
      <form
        method="post"
        action="{% url 'archive_post' post.slug %}"
        style="display: inline"
      >
        {% csrf_token %}
        <button type="submit" class="btn-archive-post">
          {% if post.is_archived %} üìÇ Unarchive Post {% else %} üìÅ Archive Post
          {% endif %}
        </button>
      </form>
    </div>
    {% endif %}
  </div>

  {% if post.category %}
  <div>
    <a
      href="{% url 'blog_home' %}?category={{ post.category.id }}"
      class="post-category"
    >
      {{ post.category.name }}
    </a>
  </div>
  {% endif %}

  <h1 class="post-title">{{ post.title }}</h1>

  <div class="post-metadata">
    <div class="metadata-item">
      <span>üìÖ</span>
      <span>{{ post.created_at|date:"F d, Y" }}</span>
    </div>
    <div class="metadata-item">
      <span>üëÅÔ∏è</span>
      <span>{{ post.views }} view{{ post.views|pluralize }}</span>
    </div>
  </div>

  <div class="author-block">
    <div class="author-info">
      <div class="author-avatar">
        {% if post.author.profile.get_avatar_data_url %}
        <img
          src="{{ post.author.profile.get_avatar_data_url }}"
          alt="{{ post.author.get_full_name }}"
        />
        {% else %}
        <div class="avatar-placeholder">
          {{ post.author.first_name.0 }}{{ post.author.last_name.0 }}
        </div>
        {% endif %}
      </div>
      <div class="author-details">
        <div class="author-name">{{ post.author.get_full_name }}</div>
        <div class="author-bio">
          {{ post.author.profile.bio|default:"Writer and content creator" }}
        </div>
      </div>
    </div>
  </div>

  {% if post.cover_image %}
  <img
    src="{{ post.get_cover_image_data_url }}"
    alt="{{ post.title }}"
    class="post-cover-image"
  />
  {% endif %}

  <article class="post-content">{{ post.content|markdown }}</article>

  {% if post.tags.all %}
  <div class="post-tags-section">
    <div class="post-tags">
      {% for tag in post.tags.all %}
      <a href="{% url 'blog_home' %}?tag={{ tag.id }}" class="tag"
        >#{{ tag.name }}</a
      >
      {% endfor %}
    </div>
  </div>
  {% endif %}

  <div class="comments-preview-section">
    <div class="comments-preview-header">
      <h3>üí¨ Discussion</h3>
      <span class="comment-count-badge"
        >{{ post.comments.count }}
        comment{{post.comments.count|pluralize}}</span
      >
    </div>
    <p class="comments-preview-text">
      Join the conversation and share your thoughts on this article.
    </p>
    <a href="{% url 'post_comments' post.slug %}" class="btn-view-comments">
      View All Comments
      <span class="btn-arrow">‚Üí</span>
    </a>
  </div>

  <div class="author-bio-card">
    <div class="bio-avatar">
      {% if post.author.profile.get_avatar_data_url %}
      <img
        src="{{ post.author.profile.get_avatar_data_url }}"
        alt="{{ post.author.get_full_name }}"
      />
      {% else %}
      <div class="avatar-placeholder-large">
        {{ post.author.first_name.0 }}{{ post.author.last_name.0 }}
      </div>
      {% endif %}
    </div>
    <div class="bio-content">
      <h3>About {{ post.author.get_full_name }}</h3>
      <p>{{ post.author.profile.bio|default:"No Bio Available" }}</p>
      <a
        href="{% url 'user_profile' username=post.author.username %}"
        class="btn-view-profile"
        >View Profile</a
      >
    </div>
  </div>
</div>
{% endblock %}
